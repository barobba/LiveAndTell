
$(document).ready(function() {

  // Make images clickable
  $('.ui-widget-content').click(function(event) {
    event.toggleClass('ui-selected');
  });
  
  // Make sure that links in the image listing cannot be clicked.
  $('.view-id-image_thumbnails .view-content a').click(function(event){
    event.preventDefault();
  });
  
  // Make notebooks clickable
  $('.add-to-activity-button').click(function (event) {
    latAlert('Adding pictures to the selected picture book. Please wait a moment.');
    // Prevent default link action
    event.preventDefault();
    // Find my NID
    var notebookNID = $(this).attr('data');
    // Add the selected items to the notebook at NID.
    var endPointURL = '/lat/process/notebook/add/image-nodes';
    var imageNIDs = $('.ui-widget-content.ui-selected .views-field-nid .field-content .node-nid')
                       .map(function(index, element){
                         return $(this).html();
                       }).get().join(':');
    $.getJSON(endPointURL, { notebook: notebookNID, images: imageNIDs }, function(json) {
      $('#lat-msgbox-overlay').fadeTo('fast', 0, function() {
        $('html').removeClass('lat-msgbox-overlay-shown');
        $('#lat-msgbox-overlay').remove();
      });      
      alert("Done. Picture have been added to the selected picture book.");
      //alert(json.result_string); // THIS SHOULD GO TO A LOG FILE, PROBABLY POSTED FROM SERVER SIDE.
      $('.ui-widget-content.ui-selected').toggleClass('ui-selected');
    });
    
  });
  
});


// TAGGED LAT IMAGE SELECTION
// Find "#activity-ui-selectable-NID" elements.
// Attach special "click" events handlers to the events.
// Toggles #activity-ui.selected|(nothing)
//
// COLLECT LAT IMAGE TAGS 
// Collect all elements with "#activity-ui.selected" path.
// Retrieve the NID of each term.
// 
// SUBMIT CONTENT
// Get the "activiy" oject.
// Point the activity to each of these IDs to the LAT Album.
